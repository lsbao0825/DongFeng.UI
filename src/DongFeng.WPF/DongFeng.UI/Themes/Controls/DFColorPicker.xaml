<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:DongFeng.UI.Controls"
                    xmlns:converters="clr-namespace:DongFeng.UI.Converters">

    <converters:HueToColorConverter x:Key="HueToColorConverter" />

    <Style x:Key="DFDFColorPicker" TargetType="{x:Type controls:DFColorPicker}">
        <Setter Property="Width" Value="250" />
        <Setter Property="Foreground" Value="{DynamicResource Brush_Text_Primary}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:DFColorPicker}">
                    <Border Background="{DynamicResource Brush_Surface}" 
                            BorderBrush="{DynamicResource Brush_Border}" 
                            BorderThickness="1" 
                            CornerRadius="4" 
                            Padding="10">
                        <StackPanel>
                            <!-- Saturation / Value Canvas -->
                            <Grid Height="150" Margin="0,0,0,10">
                                <Canvas x:Name="PART_ColorCanvas" 
                                        Background="{Binding Hue, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource HueToColorConverter}}">
                                    <Canvas.Resources>
                                        <!-- Gradients -->
                                    </Canvas.Resources>
                                </Canvas>
                                <!-- White Gradient (Left to Right) -->
                                <Border IsHitTestVisible="False">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                            <GradientStop Color="White" Offset="0" />
                                            <GradientStop Color="Transparent" Offset="1" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                                <!-- Black Gradient (Top to Bottom) -->
                                <Border IsHitTestVisible="False">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                            <GradientStop Color="Transparent" Offset="0" />
                                            <GradientStop Color="Black" Offset="1" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                                
                                <!-- Thumb -->
                                <Canvas IsHitTestVisible="False">
                                    <Border x:Name="PART_ColorThumb" Width="10" Height="10" CornerRadius="5" 
                                            BorderBrush="White" BorderThickness="2" Background="Transparent" />
                                </Canvas>
                            </Grid>

                            <!-- Hue Slider -->
                            <Slider x:Name="PART_SpectrumSlider" Minimum="0" Maximum="360" 
                                    Value="{Binding Hue, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}" 
                                    Margin="0,0,0,5" IsMoveToPointEnabled="True">
                                <Slider.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#FF0000" Offset="0.0" />
                                        <GradientStop Color="#FFFF00" Offset="0.167" />
                                        <GradientStop Color="#00FF00" Offset="0.333" />
                                        <GradientStop Color="#00FFFF" Offset="0.5" />
                                        <GradientStop Color="#0000FF" Offset="0.667" />
                                        <GradientStop Color="#FF00FF" Offset="0.833" />
                                        <GradientStop Color="#FF0000" Offset="1.0" />
                                    </LinearGradientBrush>
                                </Slider.Background>
                            </Slider>

                            <!-- Alpha Slider -->
                            <Slider x:Name="PART_AlphaSlider" Minimum="0" Maximum="255" 
                                    Value="{Binding A, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}" 
                                    Margin="0,0,0,10" IsMoveToPointEnabled="True">
                                <Slider.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#00000000" Offset="0" />
                                        <GradientStop Color="#FF000000" Offset="1" />
                                    </LinearGradientBrush>
                                </Slider.Background>
                            </Slider>

                            <!-- Selected Color Preview & Hex -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Checkerboard for Alpha preview -->
                                <Border CornerRadius="4" BorderBrush="{DynamicResource Brush_Border}" BorderThickness="1" ClipToBounds="True">
                                    <Grid>
                                        <Canvas Width="100" Height="100">
                                            <!-- Simple checkerboard pattern can be done with a DrawingBrush, but here's a lazy way or just a gray background -->
                                            <Rectangle Width="100" Height="100" Fill="#F0F0F0" />
                                        </Canvas>
                                        <Border>
                                             <Border.Background>
                                                 <SolidColorBrush Color="{Binding Color, RelativeSource={RelativeSource TemplatedParent}}" />
                                             </Border.Background>
                                        </Border>
                                    </Grid>
                                </Border>
                                
                                <TextBox Grid.Column="1" Margin="10,0,0,0" 
                                         Text="{Binding Color, RelativeSource={RelativeSource TemplatedParent}, StringFormat={}#{0}}"
                                         Background="{DynamicResource Brush_Fill}"
                                         Foreground="{DynamicResource Brush_Text_Primary}"
                                         BorderBrush="{DynamicResource Brush_Border}" />
                            </Grid>
                        </StackPanel>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource DFDFColorPicker}" TargetType="{x:Type controls:DFColorPicker}" />
    
</ResourceDictionary>
