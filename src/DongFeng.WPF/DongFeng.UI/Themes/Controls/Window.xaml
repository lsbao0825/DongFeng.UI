<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:DongFeng.UI.Controls"
    xmlns:helpers="clr-namespace:DongFeng.UI.Helpers"
    xmlns:converters="clr-namespace:DongFeng.UI.Converters">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="pack://application:,,,/DongFeng.UI;component/Themes/BaseStyles.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <converters:ObjectToVisibilityConverter x:Key="ObjectToVisibilityConverter" />

    <Style x:Key="TitleBarButtonStyle" TargetType="Button">
        <Setter Property="WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Foreground" Value="{DynamicResource DF_Text_Primary_Brush}" />
        <Setter Property="Width" Value="46" />
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="{DynamicResource DF_Border_Brush}" />
                            <!--  Subtle hover  -->
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="{DynamicResource DF_Window_TitleBar_Background}" />
                            <Setter Property="Foreground" Value="White" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style
        x:Key="CloseButtonStyle"
        BasedOn="{StaticResource TitleBarButtonStyle}"
        TargetType="Button">
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#e81123" />
                <!--  Standard Red Close  -->
                <Setter Property="Foreground" Value="White" />
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="#aa0b19" />
                <Setter Property="Foreground" Value="White" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style
        x:Key="DFWindowStyle"
        BasedOn="{StaticResource DFControlBase}"
        TargetType="{x:Type controls:DFWindow}">
        <Setter Property="WindowChrome.WindowChrome">
            <Setter.Value>
                <WindowChrome
                    CaptionHeight="{Binding TitleBarHeight, RelativeSource={RelativeSource AncestorType=controls:DFWindow}}"
                    CornerRadius="{DynamicResource DF_CornerRadius_Large}"
                    GlassFrameThickness="0"
                    ResizeBorderThickness="6"
                    UseAeroCaptionButtons="False" />
            </Setter.Value>
        </Setter>
        <Setter Property="Background" Value="{DynamicResource DF_Background_Brush}" />
        <Setter Property="BorderBrush" Value="{DynamicResource DF_Border_Brush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="FontFamily" Value="Microsoft YaHei UI" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="TitleBarBackground" Value="{DynamicResource DF_Background_Brush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:DFWindow}">
                    <Border
                        x:Name="WindowBorder"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <!--  Title Bar  -->
                            <Grid
                                x:Name="PART_TitleBar"
                                Grid.Row="0"
                                Height="{TemplateBinding TitleBarHeight}"
                                Panel.ZIndex="999"
                                Background="{TemplateBinding TitleBarBackground}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <!--  Icon & Title  -->
                                    <ColumnDefinition Width="*" />
                                    <!--  Content  -->
                                    <ColumnDefinition Width="Auto" />
                                    <!--  Buttons  -->
                                </Grid.ColumnDefinitions>

                                <!--  Icon & Title Group  -->
                                <StackPanel
                                    Grid.Column="0"
                                    Margin="10,0"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">

                                    <Grid
                                        Margin="0,0,10,0"
                                        VerticalAlignment="Center"
                                        Visibility="{TemplateBinding ShowIcon,
                                                                     Converter={StaticResource BooleanToVisibilityConverter}}"
                                        WindowChrome.IsHitTestVisibleInChrome="True">
                                        <Image
                                            x:Name="WindowIcon"
                                            Width="16"
                                            Height="16"
                                            Source="{TemplateBinding Icon}"
                                            Visibility="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource ObjectToVisibilityConverter}}"/>

                                    </Grid>

                                    <TextBlock
                                        VerticalAlignment="Center"
                                        FontSize="{DynamicResource DF_FontSize_Normal}"
                                        Text="{TemplateBinding Title}"
                                        Visibility="{TemplateBinding ShowTitle,
                                                                     Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </StackPanel>

                                <!--  Custom TitleBar Content  -->
                                <ContentPresenter
                                    Grid.Column="1"
                                    Margin="20,0"
                                    Content="{TemplateBinding TitleBarContent}"
                                    WindowChrome.IsHitTestVisibleInChrome="True" />

                                <!--  System Buttons  -->
                                <StackPanel
                                    Grid.Column="2"
                                    VerticalAlignment="Stretch"
                                    Orientation="Horizontal"
                                    WindowChrome.IsHitTestVisibleInChrome="True">
                                    <Button Command="{x:Static SystemCommands.MinimizeWindowCommand}" Style="{StaticResource TitleBarButtonStyle}">
                                        <Path
                                            Width="10"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Data="M0,0 L10,0"
                                            Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                            StrokeThickness="1" />
                                    </Button>
                                    <Button
                                        x:Name="MaximizeButton"
                                        Command="{x:Static SystemCommands.MaximizeWindowCommand}"
                                        Style="{StaticResource TitleBarButtonStyle}">
                                        <Path
                                            Width="10"
                                            Height="10"
                                            Data="M 1.5,8.5 L 8.5,1.5 M 8.5,1.5 H 5.5 M 8.5,1.5 V 4.5 M 1.5,8.5 H 4.5 M 1.5,8.5 V 5.5"
                                            Fill="Transparent"
                                            Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                            StrokeThickness="1" />
                                    </Button>
                                    <Button
                                        x:Name="RestoreButton"
                                        Command="{x:Static SystemCommands.RestoreWindowCommand}"
                                        Style="{StaticResource TitleBarButtonStyle}"
                                        Visibility="Collapsed">
                                        <Path
                                            Width="10"
                                            Height="10"
                                            Data="M 1.5,3.5 H 7.5 V 9.5 H 1.5 Z M 3.5,3.5 V 1.5 H 9.5 V 7.5 H 7.5"
                                            Fill="Transparent"
                                            Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                            StrokeThickness="1" />
                                    </Button>
                                    <Button Command="{x:Static SystemCommands.CloseWindowCommand}" Style="{StaticResource CloseButtonStyle}">
                                        <Path
                                            Width="10"
                                            Height="10"
                                            Data="M0,0 L10,10 M0,10 L10,0"
                                            Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                            StrokeThickness="1" />
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <!--  Client Area  -->
                            <AdornerDecorator x:Name="ClientAreaDecorator" Grid.Row="1">
                                <controls:DFLoading
                                    x:Name="PART_WindowDFLoading"
                                    DFLoadingText="{TemplateBinding DFLoadingText}"
                                    IsCancellable="{TemplateBinding IsDFLoadingCancellable}"
                                    IsDFLoading="{TemplateBinding IsDFLoading}">
                                    <ContentPresenter x:Name="PART_MainContent" ClipToBounds="True" />
                                </controls:DFLoading>
                            </AdornerDecorator>

                            <!--  Message Container  -->
                            <StackPanel
                                x:Name="PART_MessageContainer"
                                Grid.Row="0"
                                Grid.RowSpan="2"
                                Margin="0,40,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Top"
                                Panel.ZIndex="2000"
                                IsHitTestVisible="False" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="ExtendViewIntoTitleBar" Value="True">
                            <Setter TargetName="ClientAreaDecorator" Property="Grid.Row" Value="0" />
                            <Setter TargetName="ClientAreaDecorator" Property="Grid.RowSpan" Value="2" />
                            <Setter TargetName="PART_TitleBar" Property="Background" Value="Transparent" />
                        </Trigger>
                        <Trigger Property="WindowState" Value="Maximized">
                            <Setter TargetName="MaximizeButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="RestoreButton" Property="Visibility" Value="Visible" />
                            <Setter TargetName="WindowBorder" Property="BorderThickness" Value="0" />
                            <Setter TargetName="WindowBorder" Property="Padding" Value="8" />
                        </Trigger>
                        <Trigger Property="IsActive" Value="False">
                            <Setter Property="Opacity" Value="0.98" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>